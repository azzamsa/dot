#!/usr/bin/env -S cargo +nightly -Zscript --quiet
---
[package]
edition = "2021"

[dependencies]
jiff = "0.1.3"
owo-colors = "4.0"
anyhow = "1.0"
---
//! Timezones
//!
//! Shows the timezones of my friends and companies.
//!
//! Usage:
//!
//! Just run it as normal executable file:
//!
//! ```shell
//! $ ./tz
//! ```
//!
//! Development:
//!
//! ```
//! $ rustfmt tz
//! ```

use owo_colors::OwoColorize;
use jiff::{Unit, Zoned};

fn main() -> anyhow::Result<()> {
    run()?;

    Ok(())
}

fn run() -> anyhow::Result<()> {
    let now= Zoned::now().round(Unit::Second)?;

    // Cape Town, South Africa (UTC+2)
    show_time(now.intz("Africa/Johannesburg")?, "Cape Town, South Africa");
    let friends = vec!["Alice"];
    show_friends(&friends);

    // San Francisco, USA (UTC-7)
    show_time(now.intz("America/Los_Angeles")?, "San Francisco, USA");
    let friends = vec!["Bob", "Aragorn"];
    show_friends(&friends);

    Ok(())
}

// Show the related time
fn show_time(time: Zoned, location: &str) {
    println!(
        "{}",
        format!("{}: {}", location, time.strftime("%I:%M %p"))
            .bold()
            .green()
    );
}

// Show friends or companies
fn show_friends(items: &[&str]) {
    for item in items {
        println!("- {}", item);
    }
}

// vim: ft=rust
