#!/bin/sh

: '
Wezterm Here (wezterm-here)
~~~~~~~~~~~~~~~~~~~~~
Open wezterm terminal in given directory.

Usage:

```
$ wezterm-here "/opt"
  ::: Socket found: /run/user/1000/wezterm/gui-sock-15163
  2
```

Usage from other application:

``` lisp
(defun terminal-here ()
  (interactive)
  (message "Opening terminal in %s" default-directory)
  (start-process "" nil "wezterm-here" default-directory))
```
'

# takes the path as an argument (e.g. /opt)
if [ -n "$1" ]; then
    path="$1"
else
    echo "::: No path passed. Use '$HOME' as default"
    path="$HOME"
fi

for socket in /run/user/1000/wezterm/gui-sock-*
do
  [ -S "$socket" ] && break;
done

if [ -n "$socket" ]
then
    echo "::: Socket found: $socket"
    echo "::: Open terminal in: '$path'"
    env WEZTERM_UNIX_SOCKET="$socket" wezterm cli spawn --window-id 0 --cwd "$path"
fi
